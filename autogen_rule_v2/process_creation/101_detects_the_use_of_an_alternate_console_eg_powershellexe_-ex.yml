id: e0006032-fdb9-43f7-9c62-ae8491d566f5
status: test
description: Detects the use of an alternate console (e.g., powershell.exe -ExecutionPolicy
  Bypass) by a script (possible policy evasion)
author: AutoGenerated
date: '2025-07-12'
modified: 2022-11-29
tags:
- attack.defense-evasion
- attack.t1059
logsource:
  category: process_creation
  product: windows
detection:
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_cli:
    CommandLine|contains:
    - ' -ExecutionPolicy '
    - ' -ep '
    - ' -epbypass '
    - ' -eppolicy '
    - ' -w hidden'
    - ' -w 1'
    - ' -w 2'
    - ' -w 3'
    - ' -w 4'
    - ' -w 5'
    - ' -w h'
    - ' -w hidden'
    - ' -w low'
    - ' -w 1'
    - ' -w 2'
    - ' -w 3'
    - ' -w 4'
    - ' -w 5'
    - ' -w h'
  condition: all of selection_*
falsepositives:
- Unknown
level: medium
title: '[AUTO] Detects the use of an alternate console (e.g., powershell.exe -ExecutionPolicy
  Bypass) by a script (possible policy evasion)'
