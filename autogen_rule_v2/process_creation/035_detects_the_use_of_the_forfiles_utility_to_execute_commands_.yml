id: 5090d601-09c6-49ff-a016-33536d3c456a
status: test
description: Detects the use of the "forfiles" utility to execute commands, which
  could be a sign of UAC bypass attempts
author: AutoGenerated
date: '2025-07-12'
modified: 2023-02-09
tags:
- attack.defense-evasion
- attack.t1218
logsource:
  category: process_creation
  product: windows
detection:
  selection_img:
  - Image|endswith: \forfiles.exe
  - OriginalFileName: FORFILES.EXE
  selection_cli:
    CommandLine|contains:
    - cmd /c
    - cmd /k
    - cmd /r
    - cmd /q
    - cmd /t
    - cmd /u
    - cmd /v
    - cmd /w
    - cmd /y
  condition: all of selection_*
falsepositives:
- Unknown
level: medium
title: '[AUTO] Detects the use of the "forfiles" utility to execute commands, which
  could be a sign of UAC bypass attempts'
